Traceback (most recent call last):
  File "/home/codespace/.local/lib/python3.12/site-packages/jupyter_core/utils/__init__.py", line 154, in wrapped
    asyncio.get_running_loop()
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/home/codespace/.local/lib/python3.12/site-packages/nbclient/client.py", line 1319, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/codespace/.local/lib/python3.12/site-packages/jupyter_core/utils/__init__.py", line 158, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python/3.12.1/lib/python3.12/asyncio/base_events.py", line 684, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/codespace/.local/lib/python3.12/site-packages/nbclient/client.py", line 709, in async_execute
    await self.async_execute_cell(
  File "/home/codespace/.local/lib/python3.12/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/codespace/.local/lib/python3.12/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
# scripts/train_model.py

import os
import numpy as np
from tslearn.datasets import UCR_UEA_datasets
from sklearn.preprocessing import StandardScaler
from sklearn.linear_model import LogisticRegression
import joblib

# ------------------------------
# 1. Setup folder
# ------------------------------
BASE_DIR = os.path.dirname(os.path.abspath(__file__))
MODEL_DIR = os.path.join(BASE_DIR, "..", "models")
os.makedirs(MODEL_DIR, exist_ok=True)

# ------------------------------
# 2. Load dataset EthanolConcentration
# ------------------------------
dataset = UCR_UEA_datasets()
X_train, y_train, X_test, y_test = dataset.load_dataset("EthanolConcentration")

print("Shape X_train:", X_train.shape)
print("Shape X_test :", X_test.shape)

# ------------------------------
# 3. Flatten time-series menjadi 1D per sampel
# Bentuk 3D -> 2D (samples, timesteps*channels)
# ------------------------------
X_train_flat = X_train.reshape(X_train.shape[0], -1)
X_test_flat  = X_test.reshape(X_test.shape[0], -1)
print("Shape setelah flatten:", X_train_flat.shape, X_test_flat.shape)

# ------------------------------
# 4. Normalisasi fitur
# ------------------------------
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train_flat)
X_test_scaled  = scaler.transform(X_test_flat)

# ------------------------------
# 5. Training Logistic Regression
# ------------------------------
logreg = LogisticRegression(
    solver="liblinear",
    max_iter=3000,
    multi_class="auto"
)
logreg.fit(X_train_scaled, y_train)

# ------------------------------
# 6. Simpan model & scaler ke folder models/
# ------------------------------
model_path = os.path.join(MODEL_DIR, "logreg_model.pkl")
scaler_path = os.path.join(MODEL_DIR, "scaler.pkl")

joblib.dump(logreg, model_path)
joblib.dump(scaler, scaler_path)

print("Model Logistic Regression berhasil disimpan ->", model_path)
print("Scaler berhasil disimpan ->", scaler_path)

------------------


[31m---------------------------------------------------------------------------[39m
[31mNameError[39m                                 Traceback (most recent call last)
[36mCell[39m[36m [39m[32mIn[16][39m[32m, line 13[39m
[32m      8[39m [38;5;28;01mimport[39;00m[38;5;250m [39m[34;01mjoblib[39;00m
[32m     10[39m [38;5;66;03m# ------------------------------[39;00m
[32m     11[39m [38;5;66;03m# 1. Setup folder[39;00m
[32m     12[39m [38;5;66;03m# ------------------------------[39;00m
[32m---> [39m[32m13[39m BASE_DIR = os.path.dirname(os.path.abspath([34;43m__file__[39;49m))
[32m     14[39m MODEL_DIR = os.path.join(BASE_DIR, [33m"[39m[33m..[39m[33m"[39m, [33m"[39m[33mmodels[39m[33m"[39m)
[32m     15[39m os.makedirs(MODEL_DIR, exist_ok=[38;5;28;01mTrue[39;00m)

[31mNameError[39m: name '__file__' is not defined

